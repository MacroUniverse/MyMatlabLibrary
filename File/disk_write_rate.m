% 统计文件夹数据写入速率
% 每 5min 统计一次文件夹大小，然后画图
% for ((i=0;i<10000000;++i)) do du -s .; printf '';  sleep 300; done

file_size = [
    1246671161
    1268167557
    1288167215
    1307493715
    1327724483
    1343897400
    1364604573 % 大概从这里 (7) 开始用 win 拷贝
    1384248793
    1402485387
    1424715824
    1445881849
    1463083140
    1483040952
    1487600770 % 这里文件拷完了，中断了一下
    1504683095
    1520859400
    1539511189 % 大概这个时候开启的 gzip-9， 之前是 lz4
    1559625203
    1581206189
    1605752055
    1628842035
    1650957247
    1669989250
    1687529942
    1707783883
    1734453804
    1754297377
    1775679569
    1795445015
    1816254391
    1839382211
    1860602638
    1877852596
    1899990927
    1917894429
    1939828313
    1960301742
    1983033567
    2005904923
    2030156696
    2051256937
    2071170160
    2093740736
    2113811180
    2135437963
    2152883393
    2173928280
    2195191481
    2214624121
    2236235509
    2258261361
    2279136660
    2301433724
    2321055666
    2342985914
    2355036462
    2355036462
    2355036462
    2355036462
    2355036462
    2355036462
    2367625333
    2399733270
    2432253629
    2463110406
    2494329394
    2529133008
    2557588534
    2584978369
    2584981588
    2584984901
    2584987416
    2584990287 % 下面开始重新使用 rsync
    2595287544
    2624758169
    2644271084
    2676200453
    2676750757
    2695682449
    2724469877
    2754260961
    2776930787
    2793013459
    2807618869
    2823604190
    2837529061
    2854513340
    2867451163
    2884064516
    2897793271
    2914026772
    2932875828
    2953149851
    2974532903
    2996409846
    3017649709
    3036722644
    3058101902
    3076100982
    3093938217
    3111249091
    3129332355
    3151914089
    3171832970
    3190625728
    3202285775
    3224250740
    3242236037
    3264630642
    3286092471
    3308557130
    3329675387
    3350584668
    3373267505
];
rate = (diff(file_size)/1e3) / 300;
time = (0:numel(rate)-1)/12;

close all;
figure; plot(time, rate, '.-');
axis([0, max(time), 0, 120]); grid on;
xlabel 'time [hours]'
title(['data rate [MB/s] -- mean: ' num2str(mean(rate), 3)]);
